-- Test de modelo de regresión en Kafé (.kf)

import geshaDeep;



-- (a) Conjunto de entrenamiento: 6 muestras
List[List[INT]] x_train = [
    [1],
    [2],
    [3],
    [4],
    [5],
    [6]
];
-- y_train son valores float: 2, 4, 6, 8, 10, 12
List[FLOAT] y_train = [2.0, 4.0, 6.0, 8.0, 10.0, 12.0];

-- (b) Conjunto de validación: 2 muestras
List[List[INT]] x_val = [
    [7],
    [8]
];
List[FLOAT] y_val = [14.0, 16.0];

-- (c) Conjunto de prueba: 2 muestras
List[List[INT]] x_test = [
    [9],
    [10]
];
List[FLOAT] y_test = [18.0, 20.0];


GESHA reg_model = geshaDeep.regression();
GESHA r_layer = geshaDeep.create_dense(1, "linear", [1], 0.0);
reg_model.add(r_layer);

reg_model.compile("sgd", "mse", []);

reg_model.fit(x_train, y_train, 50, 1, x_val, y_val);

reg_model.summary();

reg_model.evaluate(x_test, y_test);
