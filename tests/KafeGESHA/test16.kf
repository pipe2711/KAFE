-- clustering_predict.kf
import geshaDeep;

-- Tres grupos visibles
List[List[FLOAT]] x_train = [
    [1.0, 1.0], [1.2, 0.8], [0.9, 1.1],       -- cluster A
    [5.0, 5.0], [5.1, 4.9], [4.8, 5.2],       -- cluster B
    [9.0, 1.0], [8.9, 1.2], [9.1, 0.8]        -- cluster C
];
List[List[FLOAT]] y_train = [];   -- no se usan en clustering

GESHA model = geshaDeep.clustering();
GESHA h  = geshaDeep.create_dense(6, "relu",   [2], 0.0, 42);
GESHA out = geshaDeep.create_dense(3, "softmax", [6], 0.0, 42);
model.add(h);
model.add(out);

model.compile("adam", "mse", []);   -- loss se ignora en clustering
model.fit(x_train, y_train, 150, 3);

-- predicción para un punto cercano al cluster B
List[FLOAT] sample = [5.05, 5.1];
List[FLOAT] probs = model.predict(sample);
show("Soft-asignación: " + str(probs));

model.summary();
